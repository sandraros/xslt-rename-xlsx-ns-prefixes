# xslt-rename-xlsx-ns-prefixes
Prefix namespace prefixes inside XLSX to test abap2xlsx#935

This tool is useful to make sure the program which reads the XML files still works if the namespace prefixes are different. For instance, a classic problem in ABAP programs is to `lo_workbook->find_from_name( 'sheet' )` finds `<sheet r:id="rId1" sheetId="1" name="NUM_1"/>` but fails for finding `<x:sheet r:id="rId1" sheetId="1" name="NUM_1" xmlns:x="http://schemas.openxmlformats.org/spreadsheetml/2006/main"/>` although both refer to the same namespace, and the right ABAP syntax to find in all situations should be `lo_workbook->find_from_name_ns( name = 'sheet' uri = 'http://schemas.openxmlformats.org/spreadsheetml/2006/main' ).`

Below example shows two identical XML files. The second one is generated by the tool.

Selection screen of the tool:

![image](https://user-images.githubusercontent.com/34005250/147891009-fb993d5a-cb21-4dd5-9320-a9c1d63b4599.png)

Contents of initial file `workbook.xml`:
```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" 
          xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" 
          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
          mc:Ignorable="x15 xr xr6 xr10 xr2" 
          xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main" 
          xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision" 
          xmlns:xr6="http://schemas.microsoft.com/office/spreadsheetml/2016/revision6" 
          xmlns:xr10="http://schemas.microsoft.com/office/spreadsheetml/2016/revision10" 
          xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2">
    <fileVersion appName="xl" lastEdited="7" lowestEdited="4" rupBuild="23801" />
    <workbookPr />
    <mc:AlternateContent xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
        <mc:Choice Requires="x15">
            <x15ac:absPath url="C:\Users\sandra.rossi\Documents\SAP GUI\" xmlns:x15ac="http://schemas.microsoft.com/office/spreadsheetml/2010/11/ac" />
        </mc:Choice>
    </mc:AlternateContent>
    <xr:revisionPtr revIDLastSave="0" documentId="13_ncr:1_{5ECAA2B1-4EC4-492C-9372-224A95CB3BD2}" xr6:coauthVersionLast="46" xr6:coauthVersionMax="46" xr10:uidLastSave="{00000000-0000-0000-0000-000000000000}" />
    <bookViews>
        <workbookView xWindow="1200" yWindow="1185" windowWidth="17415" windowHeight="9270" xr2:uid="{00000000-000D-0000-FFFF-FFFF00000000}" />
    </bookViews>
    <sheets>
        <sheet name="PieChart" sheetId="1" r:id="rId1" />
        <sheet name="Values" sheetId="5" r:id="rId2" />
    </sheets>
    <calcPr calcId="125725" />
</workbook>
```

Contents of generated file `new_workbook.xml`, with changed namespace prefixes:
```xml
<?xml version="1.0" encoding="utf-8"?>
<abc:workbook xmlns:abc="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
              xmlns:abcmc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
              xmlns:abcx15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main" 
              xmlns:abcxr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision" 
              xmlns:abcxr6="http://schemas.microsoft.com/office/spreadsheetml/2016/revision6" 
              xmlns:abcxr10="http://schemas.microsoft.com/office/spreadsheetml/2016/revision10" 
              xmlns:abcxr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2" 
              abcmc:Ignorable="abcx15 abcxr abcxr6 abcxr10 abcxr2">
    <abc:fileVersion appName="xl" lastEdited="7" lowestEdited="4" rupBuild="23801" />
    <abc:workbookPr />
    <abcmc:AlternateContent>
        <abcmc:Choice Requires="abcx15">
            <abcx15ac:absPath xmlns:abcx15ac="http://schemas.microsoft.com/office/spreadsheetml/2010/11/ac" url="C:\Users\sandra.rossi\Documents\SAP GUI\" />
        </abcmc:Choice>
    </abcmc:AlternateContent>
    <abcxr:revisionPtr abcxr10:uidLastSave="{00000000-0000-0000-0000-000000000000}" abcxr6:coauthVersionLast="46" abcxr6:coauthVersionMax="46" documentId="13_ncr:1_{5ECAA2B1-4EC4-492C-9372-224A95CB3BD2}" revIDLastSave="0" />
    <abc:bookViews>
        <abc:workbookView abcxr2:uid="{00000000-000D-0000-FFFF-FFFF00000000}" windowHeight="9270" windowWidth="17415" xWindow="1200" yWindow="1185" />
    </abc:bookViews>
    <abc:sheets>
        <abc:sheet xmlns:abcr="http://schemas.openxmlformats.org/officeDocument/2006/relationships" abcr:id="rId1" name="PieChart" sheetId="1" />
        <abc:sheet xmlns:abcr="http://schemas.openxmlformats.org/officeDocument/2006/relationships" abcr:id="rId2" name="Values" sheetId="5" />
    </abc:sheets>
    <abc:calcPr calcId="125725" />
</abc:workbook>
```
